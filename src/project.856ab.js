require=function e(t,a,n){function o(i,c){if(!a[i]){if(!t[i]){var l="function"==typeof require&&require;if(!c&&l)return l(i,!0);if(r)return r(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var d=a[i]={exports:{}};t[i][0].call(d.exports,function(e){var a=t[i][1][e];return o(a||e)},d,d.exports,e,t,a,n)}return a[i].exports}for(var r="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({BlockFactory:[function(e,t,a){"use strict";cc._RF.push(t,"4f9ad02PmdMiKFX8HLHwvlY","BlockFactory"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,r=n.property,i=e("../Manager/LevelManager"),c=e("../Data/SharedData"),l=e("../Manager/GridMapMamager"),u=e("../Config/GameConfig"),d=e("../Config/GridConfig"),f=e("../Utils/GlobalFunctions"),p=e("../Config/SpecialTypeConfig"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefabBlock=null,t.blockAtlas=null,t.controller=null,t.empty=null,t.activeBlock=[],t.blockPool=[],t.gridMap=null,t.maxGridX=0,t.maxGridY=0,t.maxBlock=0,t.minIndex=null,t.maxIndex=null,t}return __extends(t,e),t.prototype.getRandomIndex=function(){return cc.random0To1()<.005?0:Math.floor(cc.random0To1()*(this.maxIndex-this.minIndex)+this.minIndex)},t.prototype.init=function(e){this.gridMap=i.default.getGridMap();var t=i.default.getMaxGrid(),a=t.gridX,n=t.gridY;this.maxGridX=a,this.maxGridY=n;var o=i.default.getMinMaxIndex(),r=o.minIndex,c=o.maxIndex;return this.minIndex=r,this.maxIndex=c,this.maxBlock=a*n,this.blockPool=[],this.activeBlock=[],this.controller=e,this.createBlockFromGridMap()},t.prototype.createBlockFromGridMap=function(){var e=this,t=[];return c.default.clearQueue=[],this.gridMap.forEach(function(a,n,o){a.forEach(function(a,o,r){a.block?e.destroyMapUnit(a):a.block=e.empty,t.push(e.newBlock(n,o,a.index))})}),t},t.prototype.setMark=function(e,t){f.assert(e),e.node.getComponent("Block").setMark(t)},t.prototype.moveToPosition=function(e,t){e.node.getComponent("Block").moveToPosition(t)},t.prototype.getCurrentIndex=function(){for(var e=0;e<this.maxBlock;e++)if(!this.blockPool[e]||!this.blockPool[e].node.active)return e},t.prototype.check=function(){this.forEachBlock(function(e){f.assert(e.mapUnit)})},t.prototype.forEachBlock=function(e){this.activeBlock.forEach(function(t){e(t)})},t.prototype.newBlock=function(e,t,a){var n=this;a=a||this.getRandomIndex(),f.assert(!this.gridMap[e][t].block);var o=this.getCurrentIndex(),r=this.blockPool[o];return r?this.activeBlock[o]=r:((r=cc.instantiate(this.prefabBlock).getComponent("Block")).blockIndex=o,this.blockPool[o]=r,this.activeBlock[o]=r,r.node.on(cc.Node.EventType.TOUCH_END,function(){c.default.canTouch&&(c.default.oneBlock?c.default.oneBlock!=r&&(n.setMark(c.default.oneBlock,!1),i.default.isNear(c.default.oneBlock,r)?(c.default.twoBlock=r,n.controller.refreshView()):(c.default.oneBlock=r,n.setMark(c.default.oneBlock,!0))):(c.default.oneBlock=r,n.setMark(c.default.oneBlock,!0)))}),r.node.setScale(d.default.scale)),r.init(a),a==u.default.allPurposeIndex&&r.setToSpecialBlock(p.SpecialType.clearAll),l.default.attach(this.gridMap[e][t],r),r.node.getComponent(cc.Sprite).spriteFrame=this.blockAtlas.getSpriteFrame("block_"+a),f.assert(r.mapUnit),r},t.prototype.destroyMapUnit=function(e){if(e.block){var t=e.block;this.activeBlock[e.block.blockIndex]=null,l.default.detach(e),t.deadFunc=null}},t.prototype.setToDefault=function(){var e=this,t=this.setMark;this.forEachBlock(function(a){e.moveTo(a),t(a,!1)})},t.prototype.moveTo=function(e,t){t&&t!=e.mapUnit&&(l.default.detach(t),l.default.attach(t,e)),f.assert(e.mapUnit.block.mapUnit),this.moveToPosition(e,i.default.getPosByGrid(e.gridX,e.gridY))},t.prototype.setBlockToSpecial=function(e,t,a){if(a){var n=Math.floor(cc.random0To1()*this.activeBlock.length);this.activeBlock[n].setToSpecialBlock(t)}else e&&e.block&&e.block.setToSpecialBlock(t)},__decorate([r(cc.Prefab)],t.prototype,"prefabBlock",void 0),__decorate([r(cc.SpriteAtlas)],t.prototype,"blockAtlas",void 0),t=__decorate([o],t)}(cc.Component);a.default=s,cc._RF.pop()},{"../Config/GameConfig":"GameConfig","../Config/GridConfig":"GridConfig","../Config/SpecialTypeConfig":"SpecialTypeConfig","../Data/SharedData":"SharedData","../Manager/GridMapMamager":"GridMapMamager","../Manager/LevelManager":"LevelManager","../Utils/GlobalFunctions":"GlobalFunctions"}],Block:[function(e,t,a){"use strict";cc._RF.push(t,"874e0L5syVLGrb7INt8CyQc","Block"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,r=n.property,i=e("../Config/GameConfig"),c=e("../Config/SpecialTypeConfig"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.markSprite=null,t.gridX=null,t.gridY=null,t.mapUnit=null,t.blockIndex=-1,t.posLabel=null,t.muposLabel=null,t.specialText=null,t.flickerAction=null,t.runAction=null,t.deadFunc=null,t}return __extends(t,e),t.prototype.init=function(e){this.index=e,this.markSprite=this.node.getChildByName("mark").getComponent(cc.Sprite),this.setMark(!1),this.posLabel.node.active=!1,this.muposLabel.node.active=!1,this.specialText.string=""},t.prototype.setMark=function(e){this.markSprite.node.active=e},t.prototype.moveToPosition=function(e){this.node.stopAllActions(),this.node.runAction(cc.moveTo(i.default.delayDoGapTime,e))},t.prototype.letsBlink=function(){this.node.stopAction(this.flickerAction),this.flickerAction=this.node.runAction(cc.repeatForever(cc.sequence(cc.fadeOut(i.default.blockBlinkDuration),cc.fadeIn(i.default.blockBlinkDuration))))},t.prototype.setToSpecialBlock=function(e){switch(this.deadFunc=c.SpecialTypeConfig.specialTypeFunc[e],e){case c.SpecialType.clearCol:this.specialText.string="上下";break;case c.SpecialType.clearRow:this.specialText.string="左右";break;case c.SpecialType.clearArea2:this.specialText.string="2x2";break;case c.SpecialType.clearAll:this.specialText.string="index "+this.index;break;case c.SpecialType.clearArea1:this.specialText.string="1x1"}},t.prototype.onHide=function(){this.node.active=!1},t.prototype.onShow=function(){this.node.active=!0},__decorate([r(cc.Label)],t.prototype,"posLabel",void 0),__decorate([r(cc.Label)],t.prototype,"muposLabel",void 0),__decorate([r(cc.Label)],t.prototype,"specialText",void 0),t=__decorate([o],t)}(cc.Component);a.default=l,cc._RF.pop()},{"../Config/GameConfig":"GameConfig","../Config/SpecialTypeConfig":"SpecialTypeConfig"}],Controller:[function(e,t,a){"use strict";cc._RF.push(t,"a688bZ4TENDXpO391A+MZSo","Controller"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./Manager/LevelManager"),o=e("./Data/SharedData"),r=e("./Config/GameConfig"),i=e("./Utils/GlobalFunctions"),c=e("./Manager/GridMapMamager"),l=cc._decorator,u=l.ccclass,d=l.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bf=null,t.opTable=[[r.default.dirType.DIR_RIGHT,r.default.dirType.DIR_UP],[r.default.dirType.DIR_UP,r.default.dirType.DIR_LEFT],[r.default.dirType.DIR_LEFT,r.default.dirType.DIR_DOWN],[r.default.dirType.DIR_DOWN,r.default.dirType.DIR_RIGHT]],t.clearIndexQueue=[],t}return __extends(t,e),t.prototype.setCanTouch=function(e){o.default.canTouch=e},t.prototype.refreshView=function(){o.default.oneBlock?o.default.twoBlock?(this.setCanTouch(!1),this.switch()):this.setCanTouch(!0):(this.bf.setToDefault(),this.checkMatch())},t.prototype.switch=function(e){var t=this;c.default.swap(o.default.oneBlock.mapUnit,o.default.twoBlock.mapUnit),this.bf.moveTo(o.default.oneBlock),this.bf.moveTo(o.default.twoBlock),this.scheduleOnce(function(){e?(o.default.oneBlock=null,o.default.twoBlock=null,t.setCanTouch(!0)):t.checkMatch()},r.default.delayDoGapTime)},t.prototype.checkMatch=function(){this.getSign()?this.clear():o.default.oneBlock&&o.default.twoBlock?this.switch(!0):(o.default.oneBlock=null,o.default.twoBlock=null,this.bf.setToDefault(),this.setCanTouch(!0))},t.prototype.getSign=function(){for(var e=this,t=(r.default.matchType.SIGN_NONE,!1),a=null,o=0,i=r.default.matchRule;o<i.length;o++)!function(o){n.default.forEachMap(function(n){n.block&&(a=e.checkRule(o,n))&&(t=!0)})}(i[o]);return t},t.prototype.checkRule=function(e,t){if(e.needRotation)for(var a=0,n=this.opTable;a<n.length;a++){var o=n[a];if(this.checkCanMatch(o,e,t))return!0}else if(this.checkCanMatch(this.opTable[0],e,t))return!0;return!1},t.prototype.uniqPush=function(e){this.clearIndexQueue[e.block.blockIndex]||(this.clearIndexQueue[e.block.blockIndex]=!0,o.default.clearQueue.push(e))},t.prototype.addSpecialFunc=function(e,t){if(!e.specialMapUnit)return!1;var a=null,r=o.default.oneBlock,c=o.default.twoBlock;if(r||c)if(r==t.block||c==t.block)a=t;else for(var l=0,u=[o.default.oneBlock,o.default.twoBlock];l<u.length&&"break"!==function(o){if(o){var r=n.default.getDistance(o,t,!0),i=r.x,c=r.y;if(e.cond.forEach(function(t){i!=t[0]||c!=t[1]?e.needRotation&&c==t[0]&&i==t[1]&&(a=o.mapUnit):a=o.mapUnit}),a)return"break"}}(u[l]);l++);else a=t;if(i.assert(a),a.block.deadFunc)return!1;return e.specialMapUnit&&0!=e.specialMapUnit.length?(this.bf.setBlockToSpecial(n.default.getMapUnitByCalulate(a,e.specialMapUnit),e.specialType),this.clearIndexQueue[a.block.blockIndex]=!0,!0):(this.bf.setBlockToSpecial(n.default.getMapUnitByCalulate(a,e.specialMapUnit),e.specialType,!0),!1)},t.prototype.checkCanMatch=function(e,t,a){for(var n=a.index,o=0,r=t.cond;o<r.length;o++){var i=r[o],c=this.getBlock(e,a,i[0],i[1]);if(!this.isKindIndex(c,n))return!1}this.addSpecialFunc(t,a)||this.uniqPush(a);for(var l=0,u=t.cond;l<u.length;l++){var i=u[l],d=this.getBlock(e,a,i[0],i[1]);this.uniqPush(d)}return!0},t.prototype.isKindIndex=function(e,t){return e&&e.block&&(e.index==t||e.index==r.default.allPurposeIndex)},t.prototype.getBlock=function(e,t,a,o){var r=n.default.operate(e[0],t,a);return r?n.default.operate(e[1],r,o):null},t.prototype.dealFunc=function(e){var t=this,a=!1;if(e.deadFunc){a=!0;var n=e.deadFunc;e.deadFunc=null,this.bf.forEachBlock(function(a){n(e,a)&&(a.deadFunc&&t.dealFunc(a),t.uniqPush(a.mapUnit))})}return a},t.prototype.clear=function(){var e=this;this.setCanTouch(!1);var t=[],a=function(e,a){t[e]=t[e]?t[e]:[],t[e][a]=!0};o.default.clearQueue.forEach(function(t){e.dealFunc(t.block)}),o.default.clearQueue.forEach(function(t){a(t.gridX,t.gridY),e.bf.destroyMapUnit(t)}),o.default.clearQueue=[],this.clearIndexQueue=[],o.default.oneBlock=null,o.default.twoBlock=null,this.fillNewBlock(t)},t.prototype.parseFillList=function(e,t){var a=n.default.getGridMap(),o=[];for(var c in e)for(var l in e[c])i.assert(!a[c][l].block),o.push(a[c][l]);return i.stableSort(o,r.default.dirSortFunc[t]),o},t.prototype.getReverseDir=function(e){switch(e){case r.default.dirType.DIR_UP:return r.default.dirType.DIR_DOWN;case r.default.dirType.DIR_DOWN:return r.default.dirType.DIR_UP;case r.default.dirType.DIR_RIGHT:return r.default.dirType.DIR_LEFT;case r.default.dirType.DIR_LEFT:return r.default.dirType.DIR_RIGHT;default:i.assert(!1,e)}},t.prototype.getInPlaceBlockArray=function(){for(var e=[],t=n.default.getMaxGrid(),a=t.gridX,o=t.gridY,r=-a;r<2*a;r++){e[r]=[];for(var i=-o;i<2*o;i++)e[r][i]=0}return e},t.prototype.fillNewBlock=function(e){for(var t=this,a=o.default.currentDir,n=this.getReverseDir(o.default.currentDir),i=this.parseFillList(e,a),c=this.getInPlaceBlockArray();i[0];){var l=i[0],u=this.getTopOne(c,l,n),d=u.block,f=u.moveFromMapUnit;this.bf.moveTo(d),f&&i.push(f),i.splice(0,1)}this.scheduleOnce(function(){t.checkMatch()},r.default.delayDoGapTime)},t.prototype.getTopOne=function(e,t,a){for(var o=1,i=n.default.operate(a,t,o);i&&!i.block;)o+=1,i=n.default.operate(a,t,o);if(i){var l=i.block;return c.default.detach(i),c.default.attach(t,l),{block:l,moveFromMapUnit:i}}var u=this.bf.newBlock(t.gridX,t.gridY),d=null,f=null;switch(a){case r.default.dirType.DIR_UP:d=t.gridX,f=n.default.getMaxGrid().gridY;break;case r.default.dirType.DIR_DOWN:d=t.gridX,f=-1;break;case r.default.dirType.DIR_RIGHT:d=n.default.getMaxGrid().gridX,f=t.gridY;break;case r.default.dirType.DIR_LEFT:d=-1,f=t.gridY}var p=d,s=f;return-1==d?d-=e[d][f]:d==n.default.getMaxGrid().gridX?d+=e[d][f]:-1==f?f-=e[d][f]:f==n.default.getMaxGrid().gridY&&(f+=e[d][f]),e[p][s]++,u.node.setPosition(n.default.getPosByGrid(d,f)),{block:u}},t.prototype.letsRotate=function(){return o.default.currentDir==r.default.dirType.DIR_RIGHT?o.default.currentDir=r.default.dirType.DIR_DOWN:o.default.currentDir=o.default.currentDir+1,r.default.dirSign[o.default.currentDir]},__decorate([d(cc.Component)],t.prototype,"bf",void 0),t=__decorate([u],t)}(cc.Component);a.default=f,cc._RF.pop()},{"./Config/GameConfig":"GameConfig","./Data/SharedData":"SharedData","./Manager/GridMapMamager":"GridMapMamager","./Manager/LevelManager":"LevelManager","./Utils/GlobalFunctions":"GlobalFunctions"}],GameConfig:[function(e,t,a){"use strict";cc._RF.push(t,"0f2b4Npt5RGqJE8ep4SJcI9","GameConfig"),Object.defineProperty(a,"__esModule",{value:!0});var n,o=e("./SpecialTypeConfig");!function(e){e[e.SIGN_NONE=null]="SIGN_NONE",e[e.SIGN_THREE=3]="SIGN_THREE",e[e.SIGN_FOUR_COL=4]="SIGN_FOUR_COL",e[e.SIGN_FIVE=5]="SIGN_FIVE",e[e.SIGN_L=6]="SIGN_L",e[e.SIGN_O=7]="SIGN_O",e[e.SIGN_FOUR_ROW=8]="SIGN_FOUR_ROW",e[e.SIGN_T=9]="SIGN_T"}(n=a.matchType||(a.matchType={}));var r;!function(e){e[e.NONE=0]="NONE",e[e.GRAVITY=1]="GRAVITY",e[e.SURROUND=2]="SURROUND",e[e.DISTANT=3]="DISTANT"}(r=a.playerType||(a.playerType={}));var i;!function(e){e[e.DIR_DOWN=0]="DIR_DOWN",e[e.DIR_LEFT=1]="DIR_LEFT",e[e.DIR_UP=2]="DIR_UP",e[e.DIR_RIGHT=3]="DIR_RIGHT"}(i=a.dirType||(a.dirType={})),a.matchRule=[{sign:n.SIGN_FIVE,cond:[[0,1],[0,2],[0,3],[0,4]],specialMapUnit:[0,0],needRotation:!0,specialType:o.SpecialType.clearAll},{sign:n.SIGN_L,cond:[[0,1],[0,2],[1,0],[2,0]],specialMapUnit:[0,0],needRotation:!0,specialType:o.SpecialType.clearArea2},{sign:n.SIGN_T,cond:[[0,1],[0,-1],[1,0],[2,0]],specialMapUnit:[0,0],needRotation:!0,specialType:o.SpecialType.clearArea2},{sign:n.SIGN_FOUR_COL,cond:[[1,0],[2,0],[3,0]],specialMapUnit:[0,0],needRotation:!1,specialType:o.SpecialType.clearCol},{sign:n.SIGN_FOUR_ROW,cond:[[0,1],[0,2],[0,3]],specialMapUnit:[0,0],needRotation:!1,specialType:o.SpecialType.clearRow},{sign:n.SIGN_O,cond:[[0,1],[1,0],[1,1]],specialMapUnit:[],needRotation:!1,specialType:o.SpecialType.clearArea1},{sign:n.SIGN_THREE,cond:[[0,1],[0,2]],specialMapUnit:null,needRotation:!0,specialType:null}];var c=[];c[i.DIR_DOWN]="↓",c[i.DIR_LEFT]="←",c[i.DIR_UP]="↑",c[i.DIR_RIGHT]="→";var l=[];l[i.DIR_DOWN]=function(e,t){return e.gridX!=t.gridX||!(e.gridY<t.gridY)&&(e.gridY>t.gridY||void 0)},l[i.DIR_UP]=function(e,t){return e.gridX!=t.gridX||(e.gridY<t.gridY||!(e.gridY>t.gridY)&&void 0)},l[i.DIR_LEFT]=function(e,t){return e.gridY!=t.gridY||(e.gridX<t.gridX||!(e.gridX>t.gridX)&&void 0)},l[i.DIR_RIGHT]=function(e,t){return e.gridY!=t.gridY||!(e.gridX<t.gridX)&&(e.gridX>t.gridX||void 0)};var u=function(){function e(){}return e.delayDoGapTime=.3,e.matchType=n,e.playerType=r,e.dirType=i,e.dirSign=c,e.matchRule=a.matchRule,e.dirSortFunc=l,e.blockBlinkDuration=1,e.allPurposeIndex=0,e.gameSceneName="GameScene",e.mainSceneName="MainScene",e}();a.default=u,cc._RF.pop()},{"./SpecialTypeConfig":"SpecialTypeConfig"}],GameScene:[function(e,t,a){"use strict";cc._RF.push(t,"6660cwA3/9AZKbc4F+iGV2S","GameScene"),Object.defineProperty(a,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,r=n.property,i=e("./Manager/PlayerManager"),c=e("./Config/GameConfig"),l=e("./Manager/LevelManager"),u=e("./Manager/SharedMananger"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t.rotationBtn=null,t.bf=null,t.controller=null,t}return __extends(t,e),t.prototype.setPlayerType=function(e){i.PlayerManager.changePlayerType(e),this.rotationBtn.node.active=i.PlayerManager.isCanRotation()},t.prototype.onLoad=function(){this.bf=cc.find("BlockFactory").getComponent("BlockFactory"),this.controller=cc.find("Controller").getComponent("Controller"),this.setLevel(1),this.layout.node.setPosition(cc.p(-cc.winSize.width/2,-cc.winSize.height/2))},t.prototype.setLevel=function(e){l.default.init(e),u.default.setToDefault();var t=this.bf.init(this.controller);this.freshView(t)},t.prototype.freshView=function(e){var t=this;this.layout.node.removeAllChildren(),e.forEach(function(e){t.layout.node.addChild(e.node)}),this.controller.refreshView()},t.prototype.letsRotate=function(){this.rotationBtn.node.getChildByName("Label").getComponent("cc.Label").string=this.controller.letsRotate()},t.prototype.backToScene=function(){cc.director.loadScene(c.default.mainSceneName)},t.prototype.onDestroy=function(){u.default.setToDefault(),i.PlayerManager.setToDefault()},__decorate([r(cc.Layout)],t.prototype,"layout",void 0),__decorate([r(cc.Button)],t.prototype,"rotationBtn",void 0),t=__decorate([o],t)}(cc.Component);a.GameScene=d,cc._RF.pop()},{"./Config/GameConfig":"GameConfig","./Manager/LevelManager":"LevelManager","./Manager/PlayerManager":"PlayerManager","./Manager/SharedMananger":"SharedMananger"}],GlobalFunctions:[function(e,t,a){"use strict";cc._RF.push(t,"1b244ZMVB1AzrBgLvrdZxgs","GlobalFunctions"),Object.defineProperty(a,"__esModule",{value:!0});e("../Config/GameConfig").default.delayDoGapTime;var n=0;a.dump=function(e,t){console.log("=========="+n),console.log(e),console.log(t),console.log("-----------"+n+"\n\n\n\n"),n+=1},a.assert=function(e,t){if(e)return e;console.assert(!1,t||"ASSERTION FAILED!!!"),null.assert},a.stableSort=function(e,t){var a=e.length;if(a<=1)return e;for(var n=!1;!n;){n=!0;for(var o=0;o<a-1;o++)t(e[o+1],e[o])&&(e[o],e[o+1]=e[o+1],e[o],n=!1);a--}return e},cc._RF.pop()},{"../Config/GameConfig":"GameConfig"}],GridConfig:[function(e,t,a){"use strict";cc._RF.push(t,"b0ba2rj3bBG57Uh/sMlB96p","GridConfig"),Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(){}return e.gap=60,e.scale=.5,e.defaultOffsetX=30,e.defaultOffsetY=30,e.levelGridCount=[{xGridCount:10,yGridCount:12,minIndex:1,maxIndex:6}],e}();a.default=n,cc._RF.pop()},{}],GridMapMamager:[function(e,t,a){"use strict";cc._RF.push(t,"dfe76fhM9hFYJ7lmK1LbKdl","GridMapMamager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("../Utils/GlobalFunctions"),o=function(){function e(){}return e.attach=function(t,a){e.setMapUnit(!0,a,t),a.onShow()},e.detach=function(t){var a=t.block;a&&(a.onHide(),e.setMapUnit(!1,a,null)),t.index=null,t.block=null},e.swap=function(t,a){var n=t.block,o=a.block;e.setMapUnit(!1,n,a),e.setMapUnit(!1,o,t)},e.setMapUnit=function(e,t,a){var o=null!=t.gridX?[t.gridX,t.gridY]:[-1,-1],r=o[0],i=o[1];n.assert(-1!=r&&-1!=i||-1==r&&-1==i),t.gridX=a?a.gridX:null,t.gridY=a?a.gridY:null,t.mapUnit=a,a&&(a.block=t,a.index=t.index,e&&n.assert(-1==i||i>a.gridY))},e}();a.default=o,cc._RF.pop()},{"../Utils/GlobalFunctions":"GlobalFunctions"}],LevelData:[function(e,t,a){"use strict";cc._RF.push(t,"4f174DR3xlCCJQyTRfXCdiT","LevelData"),Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(){}return e.levelInfo=null,e}();a.default=n,cc._RF.pop()},{}],LevelManager:[function(e,t,a){"use strict";cc._RF.push(t,"cd52b6nIkFG6rI+qVx81swG","LevelManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("../Data/LevelData"),o=e("../Config/GridConfig"),r=e("../Data/MapData"),i=e("../Config/GameConfig"),c=e("../Utils/GlobalFunctions"),l=function(){return function(e,t,a,n){this.gridX=e,this.gridY=t,this.block=a,this.index=n}}(),u=function(){function e(){}return e.init=function(e){var t=o.default.levelGridCount[e-1],a={currentLevel:e,maxGridX:t.xGridCount,maxGridY:t.yGridCount,minIndex:t.minIndex,maxIndex:t.maxIndex};n.default.levelInfo=a;for(var i=0;i<t.xGridCount;i++){r.default.gridMap[i]=[];for(var c=0;c<t.yGridCount;c++)r.default.gridMap[i][c]=new l(i,c,null,null)}},e.getPosByGrid=function(e,t){r.default.gridPosMap[e]=r.default.gridPosMap[e]?r.default.gridPosMap[e]:[];var a=r.default.gridPosMap[e][t];return a?r.default.gridPosMap[e][t]:(a=cc.p(e*o.default.gap+o.default.defaultOffsetX,t*o.default.gap+o.default.defaultOffsetY),r.default.gridPosMap[e][t]=a,a)},e.getGridMap=function(){return r.default.gridMap},e.getMaxGrid=function(){return{gridX:n.default.levelInfo.maxGridX,gridY:n.default.levelInfo.maxGridY}},e.getMinMaxIndex=function(){return{minIndex:n.default.levelInfo.minIndex,maxIndex:n.default.levelInfo.maxIndex}},e.isNear=function(e,t){var a=e.gridX,n=e.gridY,o=t.gridX,r=t.gridY;return a==o&&1==Math.abs(n-r)||n==r&&1==Math.abs(a-o)},e.forEachMap=function(e){r.default.gridMap.forEach(function(t){t.forEach(e)})},e.operate=function(e,t,a){if(0==a)return t;switch(e){case i.default.dirType.DIR_UP:return r.default.gridMap[t.gridX][t.gridY+a];case i.default.dirType.DIR_DOWN:return r.default.gridMap[t.gridX][t.gridY-a];case i.default.dirType.DIR_RIGHT:return r.default.gridMap[t.gridX+a]?r.default.gridMap[t.gridX+a][t.gridY]:null;case i.default.dirType.DIR_LEFT:return r.default.gridMap[t.gridX-a]?r.default.gridMap[t.gridX-a][t.gridY]:null;default:return null}},e.getMapUnitByCalulate=function(e,t){return t&&0!=t.length&&r.default.gridMap[e.gridX+t[0]]?r.default.gridMap[e.gridX+t[0]][e.gridY+t[1]]:null},e.getDistance=function(e,t,a){var n=e.gridX-t.gridX,o=e.gridY-t.gridY;return a&&(n=Math.abs(n),o=Math.abs(o)),{x:n,y:o}},e.check=function(){e.forEachMap(function(e){c.assert(e.block),c.assert("number"==typeof e.block.gridX),c.assert(e.block.mapUnit),c.assert(e.block.gridY+1),c.assert(e.block.blockIndex==e.block.mapUnit.block.blockIndex),c.assert(e.block.node.active),c.assert(e.block.gridX==e.gridX),c.assert(e.block.gridY==e.gridY)})},e}();a.default=u,cc._RF.pop()},{"../Config/GameConfig":"GameConfig","../Config/GridConfig":"GridConfig","../Data/LevelData":"LevelData","../Data/MapData":"MapData","../Utils/GlobalFunctions":"GlobalFunctions"}],MainScene:[function(e,t,a){"use strict";cc._RF.push(t,"d48ccXSx3lIrLOuT0fpR5/d","MainScene"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("./Config/GameConfig"),o=cc._decorator,r=o.ccclass,i=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.typeGravity=function(){this.gotoNextScene(n.playerType.GRAVITY)},t.prototype.typeDistant=function(){this.gotoNextScene(n.playerType.DISTANT)},t.prototype.typeSurround=function(){this.gotoNextScene(n.playerType.SURROUND)},t.prototype.gotoNextScene=function(e){cc.director.loadScene(n.default.gameSceneName,function(t,a){a.getChildByName("Canvas").getComponent("GameScene").setPlayerType(e)})},t=__decorate([r],t)}(cc.Component));a.default=i,cc._RF.pop()},{"./Config/GameConfig":"GameConfig"}],MapData:[function(e,t,a){"use strict";cc._RF.push(t,"87d91lzqhRBYYGxVWd/xMXh","MapData"),Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(){}return e.gridMap=[],e.gridPosMap=[],e}();a.default=n,cc._RF.pop()},{}],OtherTest:[function(e,t,a){"use strict";cc._RF.push(t,"d08eeMB4WBOqby93cBhKnW8","OtherTest"),cc._RF.pop()},{}],PlayerData:[function(e,t,a){"use strict";cc._RF.push(t,"f5ea53JPndNuZU0T+6wZF8c","PlayerData"),Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(){}return e.defaultIsNearFunc=null,e.canRotation=!1,e.isNearFunc=null,e}();a.default=n,cc._RF.pop()},{}],PlayerManager:[function(e,t,a){"use strict";cc._RF.push(t,"8e15e6s3/tNo7vAnicxxUWy","PlayerManager"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("../Config/GameConfig"),o=e("./LevelManager"),r=e("../Data/PlayerData"),i=o.default.isNear,c=function(){function e(){}return e.changePlayerType=function(t){r.default.playerType=t,e.applyChangeType()},e.setToDefault=function(){r.default.canRotation=!1,o.default.isNear=i},e.applyChangeType=function(){e.setToDefault();var t=Math.abs;switch(r.default.playerType){case n.playerType.GRAVITY:r.default.canRotation=!0;break;case n.playerType.DISTANT:o.default.isNear=function(e,a){var n=e.gridX,o=e.gridY,r=a.gridX,i=a.gridY;return n==r&&t(o-i)<=2||o==i&&t(n-r)<=2};break;case n.playerType.SURROUND:o.default.isNear=function(e,a){var n=e.gridX,o=e.gridY,r=a.gridX,i=a.gridY;return t(o-i)<=1&&t(n-r)<=1}}},e.isCanRotation=function(){return r.default.canRotation},e}();a.PlayerManager=c,cc._RF.pop()},{"../Config/GameConfig":"GameConfig","../Data/PlayerData":"PlayerData","./LevelManager":"LevelManager"}],SharedData:[function(e,t,a){"use strict";cc._RF.push(t,"876cerC/I5EXL2AaOIshQxN","SharedData"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("../Config/GameConfig"),o=function(){function e(){}return e.clearQueue=[],e.canTouch=!0,e.oneBlock=null,e.twoBlock=null,e.currentDir=n.default.dirType.DIR_DOWN,e}();a.default=o,cc._RF.pop()},{"../Config/GameConfig":"GameConfig"}],SharedMananger:[function(e,t,a){"use strict";cc._RF.push(t,"f05e6VyocpKkp7VNYpfxgwu","SharedMananger"),Object.defineProperty(a,"__esModule",{value:!0});var n=e("../Data/SharedData"),o=e("../Config/GameConfig"),r=function(){function e(){}return e.setToDefault=function(){n.default.clearQueue=[],n.default.canTouch=!0,n.default.oneBlock=null,n.default.twoBlock=null,n.default.currentDir=o.default.dirType.DIR_DOWN},e}();a.default=r,cc._RF.pop()},{"../Config/GameConfig":"GameConfig","../Data/SharedData":"SharedData"}],SpecialTypeConfig:[function(e,t,a){"use strict";cc._RF.push(t,"3b317xn9/pNnJfqhgdGyBtL","SpecialTypeConfig"),Object.defineProperty(a,"__esModule",{value:!0});var n,o=Math.abs;!function(e){e[e.clearRow=1]="clearRow",e[e.clearCol=2]="clearCol",e[e.clearArea2=3]="clearArea2",e[e.clearAll=4]="clearAll",e[e.clearArea1=5]="clearArea1"}(n=a.SpecialType||(a.SpecialType={}));var r=[];r[n.clearAll]=function(e,t){return 0==e.index?t.index==Math.floor(4*cc.random0To1()+1):t.index==e.index},r[n.clearArea2]=function(e,t){return o(e.gridX-t.gridX)+o(e.gridY-t.gridY)<=2},r[n.clearArea1]=function(e,t){return o(e.gridX-t.gridX)+o(e.gridY-t.gridY)<=1},r[n.clearCol]=function(e,t){return e.gridX==t.gridX},r[n.clearRow]=function(e,t){return e.gridY==t.gridY};var i=function(){function e(){}return e.specialTypeFunc=r,e}();a.SpecialTypeConfig=i,cc._RF.pop()},{}],TestGridMap:[function(e,t,a){"use strict";cc._RF.push(t,"ddcdcxSEKhMepDFC5Uuklql","TestGridMap"),Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(){}return e.gridBlockIndex=[[1,1,2],[1,2,1]],e}();a.TGM=n,cc._RF.pop()},{}]},{},["Block","BlockFactory","GameConfig","GridConfig","SpecialTypeConfig","Controller","LevelData","MapData","PlayerData","SharedData","GameScene","MainScene","GridMapMamager","LevelManager","PlayerManager","SharedMananger","OtherTest","TestGridMap","GlobalFunctions"]);